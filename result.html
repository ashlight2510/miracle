<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <title>MIRACLE | ê²°ê³¼</title>
    <meta
      name="description"
      content="í•œêµ­ë³´ë‹¤ ì¡°ê±´ ì§€ìˆ˜ê°€ ì¡°ê¸ˆ ë” ë†’ì€ ë‚˜ë¼ì—ì„œ íƒœì–´ë‚  í™•ë¥ ì„ ìˆ«ìë¡œ ì²´ê°í•´ë³´ëŠ” í˜ì´ì§€. êµ­ê°€ ìš°ì—´ íŒë‹¨ ì—†ì´, í™•ë¥  ë¶„í¬ë§Œ ë‹¤ë£¹ë‹ˆë‹¤."
    />

    <style>
      :root {
        --bg: #0b1220;
        --card: #0f1a2e;
        --text: #e9eef7;
        --muted: #9fb0c8;
        --line: #1c2a45;
        --accent: #8be9fd;
        --gold: #ffd166;
        --good: #a7f3d0;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
        --radius: 18px;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif;
        background: radial-gradient(
            1200px 800px at 70% 10%,
            rgba(139, 233, 253, 0.08),
            transparent 60%
          ),
          radial-gradient(
            900px 600px at 20% 0%,
            rgba(255, 209, 102, 0.08),
            transparent 55%
          ),
          var(--bg);
        color: var(--text);
        line-height: 1.5;
      }
      .wrap {
        max-width: 980px;
        margin: 16px auto;
        padding: 28px 18px 60px;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 14px;
        margin-bottom: 18px;
      }
      .brand {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .logo {
        font-weight: 900;
        letter-spacing: 0.7px;
        font-size: 18px;
        color: var(--accent);
      }
      .subtitle {
        color: var(--muted);
        font-size: 14px;
      }
      .pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        border: 1px solid var(--line);
        border-radius: 999px;
        color: var(--muted);
        font-size: 12px;
        background: rgba(255, 255, 255, 0.02);
        white-space: nowrap;
      }
      .grid {
        display: grid;
        grid-template-columns: 1.1fr 0.9fr;
        gap: 14px;
      }
      @media (max-width: 880px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.03),
          rgba(255, 255, 255, 0.01)
        );
        border: 1px solid var(--line);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 18px;
      }
      .h1 {
        font-size: 26px;
        font-weight: 1000;
        margin: 2px 0 6px;
        letter-spacing: -0.2px;
      }
      .lead {
        color: var(--muted);
        margin: 0 0 14px;
      }
      .sectionTitle {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        margin: 0 0 10px;
        font-weight: 900;
      }
      .small {
        font-size: 12px;
        color: var(--muted);
      }
      .divider {
        height: 1px;
        background: var(--line);
        margin: 14px 0;
      }
      .quote {
        border-left: 3px solid rgba(139, 233, 253, 0.35);
        padding: 10px 12px;
        background: rgba(139, 233, 253, 0.06);
        border-radius: 12px;
        margin: 12px 0 0;
        color: var(--text);
      }
      .quote.gold {
        border-left-color: rgba(255, 209, 102, 0.45);
        background: rgba(255, 209, 102, 0.08);
      }
      .tag {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid var(--line);
        color: var(--muted);
        font-size: 12px;
        background: rgba(0, 0, 0, 0.15);
      }
      .kpi {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      @media (max-width: 520px) {
        .kpi {
          grid-template-columns: 1fr;
        }
      }
      .kpiCard {
        padding: 12px 12px 10px;
        border: 1px solid var(--line);
        border-radius: 16px;
        background: rgba(0, 0, 0, 0.14);
      }
      .kpiLabel {
        color: var(--muted);
        font-size: 12px;
        margin-bottom: 6px;
      }
      .kpiValue {
        font-size: 18px;
        font-weight: 1000;
      }
      .kpiNote {
        color: var(--muted);
        font-size: 12px;
        margin-top: 4px;
      }
      .heroBlock {
        text-align: center;
        padding: 10px 12px 14px;
        border-radius: 16px;
        border: 1px solid var(--line);
        background: rgba(0, 0, 0, 0.18);
      }
      .heroNumber {
        font-size: 34px;
        font-weight: 1000;
        letter-spacing: -0.4px;
        margin: 10px 0 6px;
        color: var(--gold);
      }
      .heroPercent {
        color: var(--muted);
        font-size: 13px;
      }
      .pause {
        text-align: center;
        color: var(--muted);
        font-size: 12px;
        margin: 10px 0;
      }
      .track {
        height: 12px;
        background: rgba(255, 255, 255, 0.04);
        border-radius: 999px;
        margin-top: 10px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.04);
      }
      .fill {
        height: 100%;
        width: 0;
        background: rgba(139, 233, 253, 0.55);
      }
      .fill.gold {
        background: rgba(255, 209, 102, 0.55);
      }
      .fill.good {
        background: rgba(167, 243, 208, 0.55);
      }
      .row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .btn {
        cursor: pointer;
        border: 1px solid var(--line);
        background: rgba(255, 255, 255, 0.03);
        color: var(--text);
        padding: 10px 12px;
        border-radius: 12px;
        font-weight: 800;
        transition: 0.15s transform ease, 0.15s background ease,
          0.15s border ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .btn:hover {
        transform: translateY(-1px);
        border-color: rgba(139, 233, 253, 0.35);
        background: rgba(139, 233, 253, 0.06);
      }
      .btn.primary {
        border-color: rgba(139, 233, 253, 0.4);
        background: rgba(139, 233, 253, 0.12);
      }
      .btn.warn {
        border-color: rgba(255, 209, 102, 0.35);
        background: rgba(255, 209, 102, 0.1);
      }
      .fine {
        color: var(--muted);
        font-size: 12px;
        margin-top: 10px;
      }
      .control {
        border: 1px solid var(--line);
        border-radius: 16px;
        background: rgba(0, 0, 0, 0.14);
        padding: 12px;
      }
      .control label {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        font-weight: 900;
      }
      input[type="range"] {
        width: 100%;
        margin-top: 10px;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <header>
        <div class="brand">
          <div class="logo">MIRACLE</div>
          <div class="subtitle">í•œêµ­ë³´ë‹¤ ë” ì¢‹ì€ ì¡°ê±´ì—ì„œ íƒœì–´ë‚  í™•ë¥ ì€?</div>
        </div>
        <div class="pill">êµ­ê°€ ìš°ì—´ íŒë‹¨ âŒ Â· í™•ë¥  ë¶„í¬ë§Œ â­•</div>
      </header>

      <div class="grid">
        <!-- LEFT -->
        <main class="card">
          <div class="sectionTitle">
            <span>ğŸ¯ FINAL</span>
          </div>

          <div class="quote">
            ë‹¹ì‹ ì€<br />
            ìƒê°ë³´ë‹¤ í›¨ì”¬ ì–´ë ¤ìš´ ì¡°ê±´ì„ í†µê³¼í•´<br />
            ì—¬ê¸°ê¹Œì§€ ì™”ìŠµë‹ˆë‹¤.
          </div>

          <div class="pause">ìŠ¤í¬ë¡¤ì„ ë‚´ë ¤ë³´ì„¸ìš”</div>

          <div class="heroBlock">
            ì§€ê¸ˆê¹Œì§€ ì„ íƒí•œ ëª¨ë“  ì¡°ê±´ì„ í•©ì¹˜ë©´,<br />
            ë‹¹ì‹ ì´ ì´ í™˜ê²½ì—ì„œ íƒœì–´ë‚  í™•ë¥ ì€
            <div class="heroNumber" id="finalMainRatio">-</div>
            <div class="heroPercent" id="finalMainPercent">-</div>
          </div>

          <div class="quote">
            ì´ê±´<br />
            ë¡œë˜ë³´ë‹¤ ìš´ì´ ì¢‹ë‹¤ëŠ” ë§ì´ ì•„ë‹™ë‹ˆë‹¤.<br />
            ê·¸ëƒ¥, ì‰½ì§€ ì•Šì€ ì¡°ê±´ì„<br />
            ì´ë¯¸ í•œ ë²ˆì€ í†µê³¼í–ˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.
          </div>

          <div class="quote gold" style="margin-top: 10px">
            ì°¸ê³ ë¡œ,<br />
            ì •ì í™•ë¥ ì„ ì œì™¸í•´ë„<br />
            <b id="finalNoSpermInline">-</b> ì…ë‹ˆë‹¤.
          </div>

          <div class="sectionTitle">
            <span>ğŸ§¾ ê·¸ë˜ì„œ ë‹¹ì‹ ì€?</span>
          </div>

          <div class="quote" id="funLine"></div>

          <div class="quote" id="lifeMsg" style="margin-top: 10px">
            ì´ë ‡ê²Œ í¬ê·€í•œ í™•ë¥ ë¡œ íƒœì–´ë‚¬ë‹¤ë©´,<br />
            í•˜ë£¨í•˜ë£¨ë¥¼ ì¡°ê¸ˆì€ ì¦ê²ê²Œ, ì¡°ê¸ˆì€ ì•„ê»´ ì¨ë„ ë˜ì§€ ì•Šì„ê¹Œìš”?<br />
            <b>ë¡œë˜ë³´ë‹¤ ê·€í•œ ì‚¶ì´ë‹ˆê¹Œìš”.</b>
          </div>

          <div class="divider"></div>

          <div class="row">
            <a href="survey.html" class="btn primary">ğŸ”„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</a>
            <button class="btn warn" id="btnReroll">ğŸ² ë¬¸êµ¬ ìƒˆë¡œ ë½‘ê¸°</button>
            <button class="btn" id="btnCopy">ğŸ“¤ ìš”ì•½ ë¬¸êµ¬ ë³µì‚¬</button>
          </div>

          <p class="fine">
            * ì´ í˜ì´ì§€ëŠ” "ì¬ë¯¸ë¡œ ë³´ëŠ” í™•ë¥ /í†µê³„ ê¸°ë°˜ ì‹œë®¬ë ˆì´ì…˜"ì…ë‹ˆë‹¤. <br />
            * êµ­ê°€ë‚˜ ê°œì¸ì˜ ê°€ì¹˜ë¥¼ í‰ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì·¨í–¥Â·í–‰ë³µì€ ìˆ«ìë¡œ ëª»
            ì •í•´ìš”)
          </p>
        </main>

        <!-- RIGHT -->
        <aside class="card">
          <div class="sectionTitle">
            <span>ğŸ§¾ ì„ íƒ ìš”ì•½</span>
            <span class="small">ì •ì í™•ë¥  ì œì™¸</span>
          </div>

          <div class="kpi">
            <div class="kpiCard">
              <div class="kpiLabel">ì¶œìƒ ì§€ì—­</div>
              <div class="kpiValue" id="kpiRegion">-</div>
              <div class="kpiNote" id="kpiRegionNote">-</div>
            </div>
            <div class="kpiCard">
              <div class="kpiLabel">ì•ˆì • ì¡°ê±´</div>
              <div class="kpiValue" id="kpiConditionCount">-</div>
              <div class="kpiNote" id="kpiConditionRate">-</div>
            </div>
          </div>

          <div class="kpi" style="margin-top: 10px">
            <div class="kpiCard">
              <div class="kpiLabel">í”¼í•˜ê³  ì‹¶ì€ í™˜ê²½</div>
              <div class="kpiValue" id="kpiExcludeCount">-</div>
              <div class="kpiNote" id="kpiExcludeList">-</div>
            </div>
            <div class="kpiCard">
              <div class="kpiLabel">ë‚¨ëŠ” í™•ë¥ </div>
              <div class="kpiValue" id="kpiRemaining">-</div>
              <div class="kpiNote" id="kpiRemainingMsg">ì„ íƒ ê¸°ì¤€ ê³±ì…ˆ</div>
            </div>
          </div>

          <details style="margin-top: 12px">
            <summary class="sectionTitle" style="cursor: pointer">
              <span>ğŸ§  ì„¤ëª… / About</span>
              <span class="small">í¼ì¹˜ê¸°</span>
            </summary>
            <div class="quote" style="margin-top: 10px">
              - "ì¢‹ê³  ë‚˜ì¨"ì´ ì•„ë‹ˆë¼ <b>ì¡°ê±´ ì§€ìˆ˜</b> ê¸°ì¤€ì…ë‹ˆë‹¤. <br />
              - <b>êµ­ê°€ ìˆ˜</b>ê°€ ì•„ë‹ˆë¼ <b>ì¸êµ¬ ê¸°ì¤€</b>ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ê²Œ
              í•µì‹¬ì…ë‹ˆë‹¤. <br />
              - ê²¹ì¹¨ì€ <b>ë§ì…ˆì´ ì•„ë‹ˆë¼ ê³±ì…ˆ</b>ìœ¼ë¡œ ë³´ì •í•©ë‹ˆë‹¤. <br />
              - ê·¸ë˜ì„œ "ìƒê°ë³´ë‹¤ ì ë‹¤"ê°€ ìˆ«ìë¡œ ì²´ê°ë©ë‹ˆë‹¤.
            </div>
            <div class="quote" style="margin-top: 10px">
              ì „ ì„¸ê³„ì—ëŠ” ì¶œìƒ ê°€ëŠ¥í•œ êµ­ê°€ê°€ ì•½ <b>204ê°œ</b> ì¡´ì¬í•©ë‹ˆë‹¤. <br />
              (ë°”í‹°ì¹¸ì€ 'ì¶œìƒ êµ­ê°€'ê°€ ì•„ë‹ˆë¯€ë¡œ ì œì™¸)
            </div>
            <div class="divider"></div>
            <div class="row">
              <a href="index.html" class="btn">ğŸ  ì²˜ìŒìœ¼ë¡œ</a>
              <a
                class="btn"
                href="https://funnyfunny.cloud"
                target="_blank"
                rel="noreferrer"
                >ğŸ§© ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</a
              >
            </div>
          </details>
        </aside>
      </div>
    </div>

    <script>
      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì„¤ë¬¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const urlParams = new URLSearchParams(window.location.search);
      const region = urlParams.get("region") || "kr";
      const conditions = urlParams.get("conditions") || "1111";
      const exclusions = (urlParams.get("exclusions") || "")
        .split(",")
        .filter(Boolean);
      const remaining = parseFloat(urlParams.get("remaining") || "1");

      const funLines = [
        "ì´ë¯¸ í•œ ë²ˆ í™•ë¥ ì ìœ¼ë¡œ ì´ê¸´ ì‚¬ëŒì´ë¼ë©´,<br />ì˜¤ëŠ˜ í•˜ë£¨ì¯¤ì€ ì¡°ê¸ˆ ëŒ€ì¶© ì‚´ì•„ë„ ê´œì°®ì§€ ì•Šì„ê¹Œìš”?",
        "ì´ ì •ë„ í™•ë¥ ì´ë©´<br />ì¸ìƒ ë‚œì´ë„ëŠ” ì´ë¯¸ â€˜í•˜ë“œ ëª¨ë“œâ€™ í´ë¦¬ì–´ì…ë‹ˆë‹¤.",
        "í™•ë¥ ì ìœ¼ë¡œ ì´ ì •ë„ë©´,<br />ë‹¹ì‹ ì€ ê½¤ë‚˜ ê·€í•œ ì¶œë°œì ì— ì„œ ìˆìŠµë‹ˆë‹¤.",
        "ì‰½ì§€ ì•Šì€ ì¡°ê±´ì„ í†µê³¼í–ˆë‹¤ëŠ” ê±´,<br />ì´ë¯¸ í•œ ë²ˆì€ â€˜ìš´â€™ì´ ë‹¹ì‹  í¸ì´ì—ˆë‹¤ëŠ” ëœ».",
        "ì„¸ìƒì— ì‰¬ìš´ ì¶œë°œì€ ì—†ì§€ë§Œ,<br />ë‹¹ì‹ ì€ ê·¸ì¤‘ì—ì„œë„ ê½¤ ì–´ë ¤ìš´ êµ¬ê°„ì„ ë„˜ì—ˆìŠµë‹ˆë‹¤.",
      ];

      const $ = (id) => document.getElementById(id);

      const conditionCount = conditions.split("").filter((c) => c === "1")
        .length;
      const conditionRateMap = {
        1: "ì•½ 45%",
        2: "ì•½ 30%",
        3: "ì•½ 17%",
        4: "ì•½ 8~9%",
      };
      const conditionProbMap = {
        1: 0.45,
        2: 0.3,
        3: 0.17,
        4: 0.085,
      };

      const exclusionLabels = {
        exChina: "ì¤‘êµ­",
        exIndia: "ì¸ë„",
        exAfrica: "ì•„í”„ë¦¬ì¹´ ì§€ì—­",
        exConflict: "ë¶„ìŸÂ·ë‚´ì „ ìœ„í—˜",
        exLowEdu: "êµìœ¡ ì ‘ê·¼ ì–´ë ¤ì›€",
        exLowHealth: "ì˜ë£Œ ì ‘ê·¼ ì–´ë ¤ì›€",
        exUnsafe: "ì¹˜ì•ˆ ë¶ˆì•ˆ",
        exExtremePoverty: "ê·¹ì €ì†Œë“ êµ­ê°€",
        exWater: "ì‹ìˆ˜Â·ìœ„ìƒ ì·¨ì•½",
        exCorruption: "ë¶€íŒ¨Â·ë²•ì¹˜ ì·¨ì•½",
      };

      const excludeNames = exclusions.map(
        (key) => exclusionLabels[key] || key
      );
      const excludeSummary =
        excludeNames.length === 0
          ? "ì„ íƒ ì—†ìŒ"
          : excludeNames.length <= 3
          ? excludeNames.join(", ")
          : `${excludeNames.slice(0, 3).join(", ")} ì™¸ ${
              excludeNames.length - 3
            }ê°œ`;

      $("kpiRegion").textContent =
        region === "kr" ? "ëŒ€í•œë¯¼êµ­" : "ê¸°íƒ€ êµ­ê°€";
      $("kpiRegionNote").textContent =
        region === "kr"
          ? "ì „ ì„¸ê³„ ì¸êµ¬ ëŒ€ë¹„ ì•½ 0.6%"
          : "ì „ ì„¸ê³„ ì¸êµ¬ ëŒ€ë¹„ ê°’ì€ ì§€ì—­ì— ë”°ë¼ ë‹¤ë¦„";
      $("kpiConditionCount").textContent = `${conditionCount}ê°œ ì„ íƒ`;
      $("kpiConditionRate").textContent =
        conditionRateMap[conditionCount] || "ì„ íƒ ì—†ìŒ";
      $("kpiExcludeCount").textContent = `${excludeNames.length}ê°œ`;
      $("kpiExcludeList").textContent = excludeSummary;
      const remainingSafe = Number.isFinite(remaining) ? remaining : 1;
      $("kpiRemaining").textContent = `${(remainingSafe * 100).toFixed(1)}%`;

      const baseProb = region === "kr" ? 0.006 : 0.015;
      const conditionProb = conditionProbMap[conditionCount] || 1;
      const regionProb = remainingSafe;
      const spermProb = 1 / 300000000;

      const withSperm = baseProb * conditionProb * regionProb * spermProb;
      const withoutSperm = baseProb * conditionProb * regionProb;

      const withSpermRatio = Math.round(1 / withSperm).toLocaleString();
      const withoutSpermRatio = Math.round(1 / withoutSperm).toLocaleString();
      const withSpermPercent = (withSperm * 100).toFixed(10);
      const withoutSpermPercent = (withoutSperm * 100).toFixed(4);

      $("finalMainRatio").textContent = `ì•½ ${withSpermRatio}ë¶„ì˜ 1`;
      $("finalMainPercent").textContent = `${withSpermPercent}%`;
      $("finalNoSpermInline").textContent = `ì•½ ${withoutSpermRatio}ë¶„ì˜ 1 (${withoutSpermPercent}%)`;

      function reroll() {
        const idx = Math.floor(Math.random() * funLines.length);
        $("funLine").innerHTML = funLines[idx];
      }

      async function copySummary() {
        const text = `ì •ì í¬í•¨ í™•ë¥ : ì•½ ${withSpermRatio}ë¶„ì˜ 1 (${withSpermPercent}%)
ì •ì ì œì™¸ í™•ë¥ : ì•½ ${withoutSpermRatio}ë¶„ì˜ 1 (${withoutSpermPercent}%)

ê²°ë¡ : ì´ë ‡ê²Œ í¬ê·€í•œ í™•ë¥ ë¡œ íƒœì–´ë‚¬ë‹¤ë©´, í•˜ë£¨í•˜ë£¨ë¥¼ ì¡°ê¸ˆì€ ì¦ê²ê²Œ, ì¡°ê¸ˆì€ ì•„ê»´ ì¨ë„ ë˜ì§€ ì•Šì„ê¹Œìš”? ë¡œë˜ë³´ë‹¤ ê·€í•œ ì‚¶ì´ë‹ˆê¹Œìš” ğŸ˜
miracle.funnyfunny.cloud`;

        try {
          await navigator.clipboard.writeText(text);
          alert("ë³µì‚¬ ì™„ë£Œ! ì¹œêµ¬í•œí…Œ ë˜ì ¸ë³´ì ğŸ˜");
        } catch (e) {
          prompt("ë³µì‚¬í•´ì„œ ì“°ê¸°:", text);
        }
      }

      // init
      reroll();
      $("btnReroll").addEventListener("click", reroll);
      $("btnCopy").addEventListener("click", copySummary);
    </script>
  </body>
</html>
